# PyWebService

Небольшой учебный сервис на FastAPI с примерами эндпоинтов для постов и пользователей. Проект демонстрирует:
- работу с FastAPI и pydantic-схемами;
- подключение CORS (для http://localhost:8080 и http://127.0.0.1:8080);
- сжатие ответов через GZip middleware;
- работу с базой данных SQLite для хранения постов и пользователей.

## Требования
- Python 3.10+

## Установка и запуск (Poetry)
1. Клонируйте репозиторий и перейдите в директорию проекта.
2. Установите Poetry (если не установлен): https://python-poetry.org/docs/#installation
3. Установите зависимости через Poetry:
    - командой: `poetry install`
    - либо с помощью Makefile: `make install`
4. Инициализируйте базу данных (опционально):
    - `python init_db.py` - заполнит базу данных начальными данными
5. Запустите сервер разработки:

```bash
poetry run uvicorn main:app --reload
# или
make run
```

По умолчанию приложение будет доступно на http://127.0.0.1:8000

Интерактивная документация OpenAPI:
- Swagger UI: http://127.0.0.1:8000/docs
- ReDoc: http://127.0.0.1:8000/redoc

## Архитектура и файлы
- `main.py` — создание приложения, middleware, маршруты.
- `shemas.py` — pydantic-схемы запросов и ответов (пользователи и посты).
- `enums.py` — перечисления для группировки эндпоинтов.
- `database.py` — модели базы данных и настройки подключения.
- `init_db.py` — скрипт для инициализации базы данных начальными данными.

## API
Базовый корневой маршрут:
- `GET /` → `{ "Hello": "World" }`

Раздел Посты (tags: «Посты»):
- `GET /posts` — список всех постов
- `GET /posts/{id}` — один пост по ID
- `POST /posts` — создание поста
  - Тело запроса (пример):
    ```json
    {
      "title": "Заголовок поста",
      "body": "Текст поста",
      "author_id": 1
    }
    ```
- `GET /search?post_id={id}` — поиск поста по ID (query-параметр `post_id`)

Раздел Пользователи (tags: «Пользователи»):
- `GET /users` — список всех пользователей
- `GET /users/{id}` — один пользователь по ID
- `POST /users` — создание пользователя
  - Тело запроса (пример):
    ```json
    {
      "name": "Ivan",
      "surname": "Ivanov",
      "age": 17
    }
    ```

### Модели данных
Пост (
`PostResponse`):
```json
{
  "id": 1,
  "title": "Post 1",
  "body": "Lorem ipsum...",
  "author_id": 1
}
```
Пользователь (`UserResponse`):
```json
{
  "id": 1,
  "name": "Ivan",
  "surname": "Ivanov",
  "age": 17
}
```

Примечания:

- Данные хранятся в базе данных SQLite (файл `pywebservice.db`).
- CORS включён для http://localhost:8080 и http://127.0.0.1:8080.
- GZip включён для ответов больше 500 байт.

## Разработка
- Запустите сервер с `--reload` для авто‑перезапуска.
- Изучайте/тестируйте эндпоинты через Swagger UI.

## Лицензия
Свободно используйте в учебных целях.